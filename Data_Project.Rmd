---
title: "Data Project"
description: |
  Abalone Data from Kaggle 
author:
  - name: Nora Jones 
    url: https://example.com/norajones

date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Data Set: Abalone from Kaggle 

My Goal: Plot Linear Models with this data 


Really!  I'm lost so I'm switching to an easier data set.  
Abalone is what another student is working on so I'm going to try to look at this data set: 

ABALONE:  a marine snail.  You can read about it here in Wikipedia!  

Great, I'm looking at house prices and then  I am changing to snails. 

```{r}
library(caret)
library(ggplot2)
library(tidyverse)
library(readxl)
library(psych)
library(knitr)

```
```{r}
library(readr)
abalone <- read_csv("abalone.csv")
View(abalone)

```

```{r}
   # Create a column name from abalone.txt to get a description of each record value
    colnames(abalone) <- c('Sex', 'Length', 'Diameter', 'Height', 'WholeWeight', 'ShuckedWeight',
                           'VisceraWeight', 'ShellWeight', 'Rings')

```
# Get a summary of data 
```{r}
 summary(abalone)
```
# Get type of data
```{r}
  sapply(abalone, class)
```

# Plotting Age Linear Models
According to correlation results more correlation is between ShellWeight and Rings and Length and Rings

```{r}
qplot(Length, Rings, data=abalone, color=Sex) + geom_point() + geom_smooth(method="lm")
```
  
```{r}
qplot(ShellWeight, Rings, data=abalone, color=Sex) + geom_point() + geom_smooth(method="lm")
```
# Comparison linear models
We will compare some models in order to select the best
   
```{r}
    modelFitAll <- lm(Rings ~ ., data = abalone) 
    modelFitMultiple <- lm(Rings ~ ShellWeight + Length, data = abalone)   
    modelFitShellWeight <- lm(Rings ~ ShellWeight, data = abalone) 
    plot(resid(modelFitShellWeight), col="Blue")
```
```{r}
anova(modelFitMultiple, modelFitShellWeight, test="Chisq")
```
```{r}
    anova(modelFitAll, modelFitShellWeight, test="Chisq")
```

# Seems than better model is taking into account all variables to predict Rings
```{r}
summary(modelFitAll)
```
```{r}
   plot(modelFitAll)
```
```{r}
   # Rings linear model
    inTrainRings <- createDataPartition(y=abalone$Rings, p=0.75, list=FALSE)
    trainingRings <- abalone[inTrainRings,]
    testingRings <- abalone[-inTrainRings,]
    set.seed(1234)
    modelFitRings <- train(Rings~., data=trainingRings, method="lm")
    #predict(modelFitRings, data = testingRings)
    sqrt(sum((modelFitRings$fitted - trainingRings$Rings)^2))
```
```{r}
sqrt(sum((predict(modelFitRings, newdata = testingRings) - testingRings$Rings)^2))
```
    


